## 配信可能な地図サービス

ArcGIS for Developers にはお手持ちの地図データや住所/緯度経度を含む CSV などのテキスト データをもとに地図（GIS）サービスを配信することが可能です。ArcGIS の地図サービスはさまざまな機能ごとに種類が分かれています。ArcGIS for Developers で配信可能な地図サービスは以下の基本的な 2 種類です。

* __フィーチャ サービス（レイヤー）__
> 緯度経度および属性情報を文字列で配信（地図データはクライアントでグラフィックとして描画されます）
> 機能: 表示（地図と属性）/検索/作成/更新/削除

* __タイル サービス（レイヤー）__
> あらかじめ作成しておいたタイル状に分割された地図画像を配信（地図データはクライアントで画像として描画されます）
> 機能: 表示（地図のみ）

タイル サービスとしては Esri が配信している全世界の背景地図サービスを無償で利用できます。
なお、タイル生成サービスを利用する場合は、[1,000 タイル生成につき、1 クレジット消費します](http://www.esrij.com/products/arcgis-online/credits/maptile/)。
ArcGIS for Developers のみでタイル サービスを公開する方法は ArcGIS Online ヘルプの[ホスト タイル レイヤーの公開](http://doc.arcgis.com/ja/arcgis-online/share-maps/publish-tiles.htm#ESRI_SECTION1_F68FCBD33BD54117B23232D41A762E89)をご覧ください。

以下では、主題データとして利用頻度のもっとも高いフィーチャ サービスの公開および配信方法をご紹介します。

## フィーチャ サービスの作成・公開

フィーチャ サービスの公開には以下の 2 つの方法があります。

* __空のフィーチャ サービスを公開__
> データがない状態のフィーチャ サービスを公開し、マップ ビューアーを使って手動でデータを追加していきます。

* __地図データおよび住所データを使ってフィーチャ サービスを公開__
> 地図データが持つ座標情報や住所情報をもとにフィーチャ サービスを公開します。ArcGIS for Developers のみで公開が可能なデータは以下の通りです。
> - CSV
> - GeoJSON
> - シェープファイル（Zip 形式に圧縮）
> - フィーチャ コレクション（JSON）
> - ファイル ジオデータベース（Zip 形式に圧縮）
> 
> 詳細は ArcGIS Online ヘルプの[ホスト フィーチャ レイヤーの公開](http://doc.arcgis.com/ja/arcgis-online/share-maps/publish-features.htm)をご覧ください。

以下は空のフィーチャ サービスを公開するまでのステップを紹介します。

<!--地図データや住所データを使ってフィーチャ サービスを公開する方法は「[データのインポート]()」をお読みください。-->

### 1. フィーチャ サービスの作成を開始する

<img src="http://apps.esrij.com/arcgis-dev/guide/img/featureservice/publish1.gif" width="600px">

1. [Hosted data] をクリックして My Hosted Data ページを開きます。このページには ArcGIS for Developers で配信中のサービスが表示されます。
1. [NEW FEATURE SERVICE] をクリックし、New Feature Service ページを開きます。

### 2. 基本情報の入力

<img src="http://apps.esrij.com/arcgis-dev/guide/img/featureservice/publish2.gif" width="600px">

公開するフィーチャ サービスに対して、以下の基本情報を入力します。

* Title（タイトル）
> 新しく作成するフィーチャ サービスのタイトルを入力します。タイトルに使用できる文字はアルファベット、数字、スペースおよびアンダースコアのみです。

* Description（概要）
> 作成するフィーチャ サービスの概要を入力します。

* Geometry Type（ジオメトリ タイプ）
> ジオメトリ タイプはフィーチャの図形の種類で、ポイント、ライン、ポリゴンの三種類から構成されています。ポイントは地物を点のデータで表します。観測地点などを表示するために使われます。ラインは地物を線のデータで表し、河川や道路などのフィーチャを表す場合に使用されます。ポリゴンは地物を面で表します。
> 1 つのフィーチャ サービスに対して選択できるジオメトリ タイプはいずれか 1 つです。

* Tags（タグ）
> ArcGIS for Developers 上でフィーチャ サービスを検索する際に利用します。

* Default Extent（デフォルトの表示範囲）
> デフォルトの表示範囲を決めます。地図に対して表示範囲が設定されていない場合、ここで指定した範囲が適用されます。

入力が完了したら、[CONTINUE] をクリックして次へ進みます。

### 3. フィールドの設定

<img src="http://apps.esrij.com/arcgis-dev/guide/img/featureservice/publish3.gif" width="600px">

属性とはフィーチャに関する様々な情報のことで、属性テーブルと呼ばれるデータベースに保存することができます。属性テーブルの列のことを属性フィールドと呼びます。例えば公共施設の属性には名称や所在地、分類、電話番号などを含めることができます。この属性情報をもとにシンボルやラベルを表示したり、フィーチャを検索したりすることが可能です。

属性フィールドには以下の項目を設定します。

* Field Alias（エイリアス）
> Field Alias は属性フィールドの名前を人間にもわかりやすく定義したものです。たとえば、人口の情報であれば Field Name を POP、Field Alias を Population と使い分けます。

* Field Name（フィールド名）
> Field Name はフィールドの名前をコンピューター用に定義したものです。コンピューターが理解しやすいように使用できる文字に制限があります（スペースや特殊文字は使用できません）。

* Data Type（データ型）
> 格納する情報の種類によって以下の 4 つのデータ型から選択します。属性フィールドに設定されたデータ型と異なるデータ型の値を格納することはできません。
    > * String: 文字型。文字列を格納します。
    > * Integer: 整数型。自然数を格納します。
    > * Float: 単精度浮動小数点型。小数点を持つ有理数やパーセント値などを格納します。
    > * Date: 日付型。日付、または日付と時間を格納します。

各項目を入力し、[+ ADD] をクリックすることで属性フィールドを追加できます。また、作成した属性フィールドは [REMOVE]（削除）、[EDIT]（編集）が可能です。入力が完了したら、[CONTINUE] をクリックして次へ進みます。

### 4. レンダリング

<img src="http://apps.esrij.com/arcgis-dev/guide/img/featureservice/publish4.gif" width="600px">

データを地図に表示する際のシンボルを選択します。ジオメトリ タイプごとにそれぞれ複数のシンボルが用意されています。ここで指定したシンボルはデフォルトのシンボルであり、フィーチャ サービス公開後に地図上で表示するシンボルを自由に変更することもできます。

設定が完了したら、[CONTINUE] をクリックして次へ進みます。

### 5. サービスの公開

最後に作成したサービスに問題がないか確認します。修正したい箇所がある場合、左のパネルから修正したい項目をクリックすることで各ページから修正が可能です。

問題なければ、[PUBLISH SERVICE] をクリックしてフィーチャ サービスを公開します。

## フィーチャ サービスの表示・編集

フィーチャ サービス公開後、マップ ビューアー上でフィーチャ サービスを表示して、データを追加することができます。

<img src="http://apps.esrij.com/arcgis-dev/guide/img/featureservice/publish5.gif" width="600px">

### 1. フィーチャ サービスの表示

1. ArcGIS for Developers 上で公開したフィーチャ サービスを選択して、[EDIT IN ARCGIS ONLINE] をクリックして、マップ ビューアーを起動します。
1. マップ ビューアーが起動すると、基本情報で設定した範囲で地図が表示されます。画面左側にあるコンテンツ パネルには公開したフィーチャ サービスを参照したレイヤーが表示されています。コンテンツ パネル上の凡例をクリックすると、レンダリングで設定したシンボルが表示されます。

### 2. フィーチャ サービスの編集

1. [編集] をクリックして、[フィーチャの追加] ウィンドウから追加するデータのシンボルを選択します。
1. 選択後に、地図上の任意の場所をクリックすることで新しいデータが追加されます。
1. フィーチャを追加すると、ポップアップが自動で開き、フィーチャの属性情報を編集することが可能です。

ここまで作成してきたフィーチャ サービスは「[Web マップの作成](../create-webmap)」で 1 レイヤーとして扱うことができます。自身が複数のデータをお持ちで、複数のレイヤーとして地図に表示したい場合でも、自由に追加して独自の地図をデザインすることが可能です。
